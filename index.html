<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don's Classroom Tools</title>
    <!-- START: Added Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <!-- END: Added Google Font -->

    <!-- ==== STYLESHEET REFACTORING START ==== -->
    <!-- 1. Global Stylesheet -->
    <link rel="stylesheet" href="css/style.css">

    <!-- 2. Tool-Specific Stylesheets -->
    <link rel="stylesheet" href="css/tools/answer-me-this.css">
    <link rel="stylesheet" href="css/tools/bingo-picker.css">
    <link rel="stylesheet" href="css/tools/date-weather.css">
    <link rel="stylesheet" href="css/tools/dice-roller.css">
    <link rel="stylesheet" href="css/tools/flashcard-manager.css">
    <link rel="stylesheet" href="css/tools/flashcards.css">
    <link rel="stylesheet" href="css/tools/image-reveal.css">
    <link rel="stylesheet" href="css/tools/lesson-menu.css">
    <link rel="stylesheet" href="css/tools/mystery-word.css">
    <link rel="stylesheet" href="css/tools/name-picker.css">
    <link rel="stylesheet" href="css/tools/noise-meter.css">
    <link rel="stylesheet" href="css/tools/phonics.css">
    <link rel="stylesheet" href="css/tools/scoreboard.css">
    <link rel="stylesheet" href="css/tools/sound-board.css">
    <link rel="stylesheet" href="css/tools/spinner.css">
    <link rel="stylesheet" href="css/tools/timer.css">
    <link rel="stylesheet" href="css/tools/whats-missing.css">
    <link rel="stylesheet" href="css/tools/whiteboard.css">

    <!-- 3. Placeholder for dynamic theme stylesheets, controlled by JS -->
    <link id="scoreboard-theme-stylesheet" rel="stylesheet" href="">
    <!-- ==== STYLESHEET REFACTORING END ==== -->
</head>
<body>

    <header>
        <h1>Don's Class Tools</h1>
        <!-- Removed paragraph -->
    </header>

    <!-- NEW: Icon Menu -->
    <div id="icon-menu">
        <button id="mute-btn" title="Toggle Sound">üîä</button>
        <button id="favorite-filter-btn" title="Show Favorites">‚ô°</button>
    </div>


    <div class="tool-container">

        <!-- Lesson Menu -->
        <div class="tool-card" id="lesson-menu-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            
            <h2>Lesson Menu</h2>
            
            <div id="lm-menu-display-grid" class="lm-display-area">
                <div class="lm-placeholder">Go fullscreen to build your lesson menu!</div>
            </div>

            <div id="lm-fullscreen-view">
                <button id="lm-panel-toggle-btn" title="Collapse Panel">¬´</button>
                <div id="lm-controls-panel">
                    <div class="lm-controls-content">
                        
                        <details class="lm-collapsible-section" open>
                            <summary>Save / Load Menus</summary>
                            <div class="lm-save-load-controls">
                                <select id="lm-load-select">
                                    <option value="">-- New Menu --</option>
                                </select>
                                <input type="text" id="lm-menu-name-input" placeholder="Enter Menu Name...">
                                <div class="lm-button-group">
                                    <button id="lm-save-btn" title="Save Menu">üíæ</button>
                                    <button id="lm-delete-btn" title="Delete Selected Menu">üóëÔ∏è</button>
                                    <button id="lm-export-btn" title="Export All Menus">üì§</button>
                                    <input type="file" id="lm-import-input" class="hidden" accept=".json">
                                    <label for="lm-import-input" class="button-like-label" title="Import Menus">üì•</label>
                                </div>
                            </div>
                        </details>
                        
                        <details class="lm-collapsible-section" id="lm-activities-section">
                            <summary>Add Activities</summary>
                            <div class="lm-add-activities-content">
                                <div id="lm-activity-buttons" class="lm-activity-buttons">
                                    <!-- Preset buttons will be dynamically generated by JavaScript -->
                                </div>
                                
                                <div class="lm-custom-activity-wrapper">
                                    <h4>Custom Activity</h4>
                                    <div class="lm-activity-item">
                                        <input type="text" id="lm-custom-activity-input" placeholder="Custom Activity...">
                                        <input type="text" id="lm-custom-time-input" class="lm-time-input" placeholder="Time?">
                                        <button id="lm-custom-notes-toggle" class="lm-notes-toggle-btn" title="Add/Edit Notes">üìù</button>
                                        <button id="lm-add-custom-btn">+</button>
                                    </div>
                                    <textarea id="lm-custom-notes-input" class="lm-notes-input hidden" placeholder="Notes for custom activity..."></textarea>
                                </div>
                            </div>
                        </details>
                        
                        <div class="lm-total-time-display">
                            <h4>Total Planned Time: <span id="lm-total-time">0 min</span></h4>
                        </div>
                    </div>
                </div>

                <div id="lm-menu-display-fullscreen" class="lm-display-area">
                </div>
            </div>
        </div>        

        <!-- Date & Weather -->
        <div class="tool-card" id="date-weather-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>

            <h2>Date & Weather</h2>
            <div class="dw-main-content">
                <div class="dw-left-panel">
                    <div class="dw-calendar-nav">
                        <button id="dw-prev-month-btn"><</button>
                        <h3 id="dw-calendar-header">Month Year</h3>
                        <button id="dw-next-month-btn">></button>
                    </div>
                    <div id="dw-calendar-grid">
                        <!-- Calendar will be generated by JS -->
                    </div>
                </div>
                <div class="dw-right-panel">
                    <div id="dw-month-display">Month</div>
                    <div class="dw-day-date-row">
                        <div id="dw-day-display">Day</div>
                        <div id="dw-date-display">Date</div>
                    </div>
                    <div class="dw-time-weather-row">
                        <div id="dw-time-display">00:00:00</div>
                        <div id="dw-weather-display">
                            <div class="dw-weather-controls">
                                <label for="dw-weather-select">Weather:</label>
                                <select id="dw-weather-select">
                                    <option value="sunny">Sunny</option>
                                    <option value="cloudy">Cloudy</option>
                                    <option value="rainy">Rainy</option>
                                    <option value="windy">Windy</option>
                                    <option value="snowy">Snowy</option>
                                    <option value="stormy">Stormy</option>
                                </select>
                            </div>
                            <div class="dw-weather-visuals">
                                <img id="dw-weather-img" src="assets/weather/sunny.png" alt="Sunny">
                                <div id="dw-weather-text">Sunny</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Random Name Picker -->
        <div class="tool-card" id="name-picker-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Random Name Picker</h2>
            <div class="fireworks-container" id="name-picker-fireworks"></div>
            <div class="name-picker-content">
                <div class="name-picker-panel">
                    <details class="name-list-collapsible" open>
                        <summary>Show/Hide Name List</summary>
                        <div class="name-list-collapsible-content">
                            <div class="class-list-manager">
                                <label for="class-list-select">Load Class:</label>
                                <select id="class-list-select">
                                    <option value="">-- New List --</option>
                                </select>
                                <button id="delete-class-btn" title="Delete Selected Class">üóëÔ∏è</button>
                            </div>
                            <textarea id="name-list" placeholder="Paste student names here, one per line..."></textarea>
                            <div class="name-list-actions">
                                <button id="save-class-btn">Save List</button>
                                <button id="np-export-btn" title="Export All Lists">üì§</button>
                                <input type="file" id="np-import-input" class="hidden" accept=".json">
                                <label for="np-import-input" class="button-like-label" title="Import Lists">üì•</label>
                            </div>
                        </div>
                    </details>
                    <div class="name-picker-controls">
                        <button id="pick-name-btn">Pick a Student!</button>
                        <button id="name-picker-reset-btn">Reset Picks</button>
                        <div id="group-picker-fullscreen-controls" class="hidden">
                            <input type="number" id="group-size-input" value="2" min="2" title="Group Size">
                            <button id="pick-one-group-btn">Group</button>
                            <button id="group-all-btn">Class</button>
                            <button id="undo-btn" title="Undo Last Pick">‚Ü©Ô∏è</button>
                        </div>
                    </div>
                    <div class="name-picker-options">
                        <input type="checkbox" id="dont-pick-again-check">
                        <label for="dont-pick-again-check">Don't pick again until list is reset</label>
                    </div>
                    <div id="picked-names-container" class="hidden">
                        <h4>Already Picked:</h4>
                        <ul id="picked-names-list"></ul>
                    </div>
                </div>
                <div id="picked-name"></div>
            </div>
            <div id="np-confirm-popup" class="confirm-popup hidden">
                <div class="confirm-popup-content">
                    <h3>Do You Want To Reset?</h3>
                    <p>This will clear all picked names and groups. The name list will not be changed.</p>
                    <div class="confirm-popup-buttons">
                        <button id="np-confirm-reset-btn">Yes, Reset</button>
                        <button id="np-cancel-reset-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Classroom Timer -->
        <div class="tool-card" id="timer-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Classroom Timer</h2>
            <div class="timer-layout-container">
                <div class="timer-controls-panel">
                    <div id="timer-display">05:00</div>
                    <div class="preset-timers">
                        <button class="preset-btn" data-time="60">1m</button>
                        <button class="preset-btn" data-time="120">2m</button>
                        <div class="custom-timer-setter">
                            <input type="text" id="timer-custom-input" placeholder="mm:ss">
                            <button id="timer-set-custom-btn">Set</button>
                        </div>
                    </div>
                    <div class="timer-controls">
                        <button id="timer-start-stop">Start</button>
                        <button id="timer-reset">Reset</button>
                        <div class="timer-theme-selector">
                            <label for="timer-theme">Theme:</label>
                            <select id="timer-theme">
                                <option value="bar" selected>Progress Bar</option>
                                <option value="bucket">Water Bucket</option>
                                <option value="flower">Growing Flower</option>
                                <option value="shark">Shark Chase</option>
                                <option value="marbles">Marble Jar</option>
                                <option value="pug">Pug Snack Time</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="timer-visual-container">
                    <div id="timer-theme-bar" class="timer-theme active">
                        <div id="timer-progress-bar">
                            <div id="timer-progress"></div>
                        </div>
                    </div>
                    <div id="timer-theme-bucket" class="timer-theme">
                        <div class="bucket-container">
                            <div class="water"></div>
                        </div>
                    </div>
                    <div id="timer-theme-flower" class="timer-theme">
                        <div class="flower-scene">
                            <img src="assets/flower_timer/pot.png" class="flower-pot" alt="Flower Pot">
                            <div id="flower-stem">
                                <img src="assets/flower_timer/leaf1.png" alt="Leaf" class="leaf leaf1">
                                <img src="assets/flower_timer/leaf2.png" alt="Leaf" class="leaf leaf2">
                                <div id="flower-head">
                                    <img src="assets/flower_timer/petal-center.png" class="flower-center" alt="Flower Center">
                                    <img src="assets/flower_timer/petal.png" class="petal p1" alt="Petal">
                                    <img src="assets/flower_timer/petal.png" class="petal p2" alt="Petal">
                                    <img src="assets/flower_timer/petal.png" class="petal p3" alt="Petal">
                                    <img src="assets/flower_timer/petal.png" class="petal p4" alt="Petal">
                                    <img src="assets/flower_timer/petal.png" class="petal p5" alt="Petal">
                                    <img src="assets/flower_timer/petal.png" class="petal p6" alt="Petal">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="timer-theme-marbles" class="timer-theme">
                         <div class="marbles-scene">
                            <div id="marbles-container" class="marbles-container"></div>
                            <div class="marbles-jar-overlay"></div>
                        </div>
                    </div>
                    <div id="timer-theme-shark" class="timer-theme">
                        <div class="shark-scene">
                            <div class="shark-water"></div>
                            <div id="shark-swimmer" class="shark-swimmer"></div>
                            <div id="shark" class="shark"></div>
                            <div id="shark-hug" class="shark-hug"></div>
                        </div>
                    </div>
                    <div id="timer-theme-pug" class="timer-theme">
                        <div class="pug-scene">
                            <div id="pug-dog" class="pug-dog"></div>
                            <div id="pug-food-container"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Digital Flashcards -->
        <div class="tool-card" id="flashcards-tool-card-id">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Digital Flashcards</h2>
            <div class="flashcard-top-bar">
                <div class="flashcard-nav">
                    <div class="flashcard-nav-single">
                        <button id="flashcard-prev">‚¨ÖÔ∏è</button>
                        <button id="flashcard-random">Random</button>
                        <button id="flashcard-next">‚û°Ô∏è</button>
                    </div>
                    <div class="flashcard-nav-toggle">
                        <button id="flashcard-show-all-toggle">Show All</button>
                    </div>
                    <div class="flashcard-controls">
                        <label for="flashcard-category">Category:</label>
                        <select id="flashcard-category"></select>
                    </div>
                    <!-- THIS IS THE NEW BUTTON -->
                    <button id="fc-goto-scoreboard-btn" title="Go to Scoreboard">üèÖ</button>
                </div>
            </div>
            <div id="flashcard-display-container">
                <div id="flashcard-display">
                    <div class="flashcard-face flashcard-front">Select a category</div>
                    <div class="flashcard-face flashcard-back"></div>
                </div>
            </div>
            <div id="flashcard-grid-view"></div>
        </div>

        <!-- Simple Scoreboard -->
        <div class="tool-card" id="scoreboard-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Simple Scoreboard</h2>
            <div class="scoreboard-grid-view">
                <div class="scoreboard-teams">
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team1-avatar" alt="Team 1 Avatar">
                            <input type="file" class="avatar-upload-input" id="team1-avatar-upload" data-team="1" accept="image/*">
                            <label for="team1-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team1-name" contenteditable="true">Team 1</h3>
                        <div class="team-score" id="score-team1">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="1" data-amount="1">üîº</button>
                            <button class="score-btn" data-team="1" data-amount="-1">üîΩ</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team2-avatar" alt="Team 2 Avatar">
                            <input type="file" class="avatar-upload-input" id="team2-avatar-upload" data-team="2" accept="image/*">
                            <label for="team2-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team2-name" contenteditable="true">Team 2</h3>
                        <div class="team-score" id="score-team2">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="2" data-amount="1">üîº</button>
                            <button class="score-btn" data-team="2" data-amount="-1">üîΩ</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team3-avatar" alt="Team 3 Avatar">
                            <input type="file" class="avatar-upload-input" id="team3-avatar-upload" data-team="3" accept="image/*">
                            <label for="team3-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team3-name" contenteditable="true">Team 3</h3>
                        <div class="team-score" id="score-team3">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="3" data-amount="1">üîº</button>
                            <button class="score-btn" data-team="3" data-amount="-1">üîΩ</button>
                        </div>
                    </div>
                    <div class="team">
                        <div class="team-avatar-container">
                            <img src="" class="team-avatar" id="team4-avatar" alt="Team 4 Avatar">
                            <input type="file" class="avatar-upload-input" id="team4-avatar-upload" data-team="4" accept="image/*">
                            <label for="team4-avatar-upload" class="avatar-upload-label" title="Upload Avatar">‚úèÔ∏è</label>
                        </div>
                        <h3 id="team4-name" contenteditable="true">Team 4</h3>
                        <div class="team-score" id="score-team4">0</div>
                        <div class="score-controls">
                            <button class="score-btn" data-team="4" data-amount="1">üîº</button>
                            <button class="score-btn" data-team="4" data-amount="-1">üîΩ</button>
                        </div>
                    </div>
                </div>
                <button id="reset-scores">Reset Scores</button>
            </div>
            <div id="themed-scoreboard-container" class="hidden">
                <!-- THIS IS THE NEW BUTTON -->
                <button id="sb-return-btn" title="Return to Previous Tool">‚Ü©Ô∏è</button>
                <div class="scoreboard-fullscreen-controls">
                    <div class="sb-control-group">
                        <label>Teams:</label>
                        <button id="sb-remove-team-btn" title="Remove Team">üîΩ</button>
                        <span id="sb-team-count-display">4</span>
                        <button id="sb-add-team-btn" title="Add Team">üîº</button>
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-theme-select">Theme:</label>
                        <select id="sb-theme-select">
                            <option value="default">Default</option>
                            <option value="star-jar">Star Jar</option>
                            <option value="spring">Spring</option>
                            <option value="science">Science</option>
                            <option value="music">Music</option>
                            <option value="halloween">Halloween</option>
                            <option value="christmas">Christmas</option>
                            <option value="animals">Animals</option>
                            <option value="minimalist">Minimalist</option>
                            <option value="energy-bar">Energy Bar</option>
                        </select>
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-win-score-input">Win Score:</label>
                        <input type="number" id="sb-win-score-input" min="1" value="20">
                    </div>
                    <div class="sb-control-group">
                        <label for="sb-bonus-input">Points:</label>
                        <input type="number" id="sb-bonus-input" min="1" value="1">
                    </div>
                    <div class="sb-control-group">
                        <button id="sb-reset-btn">Reset All</button>
                    </div>
                </div>
                <div id="themed-teams-container"></div>
            </div>
            <div id="winner-popup" class="hidden">
                <div class="winner-popup-content">
                    <button class="winner-popup-close">‚úñ</button>
                    <img src="" alt="Winner's Avatar" id="winner-team-avatar" class="winner-avatar">
                    <h2>üéâ WINNER! üéâ</h2>
                    <p id="winner-team-name"></p>
                </div>
            </div>
            <canvas id="confetti-canvas"></canvas>
            <div id="sb-confirm-popup" class="confirm-popup hidden">
                <div class="confirm-popup-content">
                    <h3>Reset Scores?</h3>
                    <p>Team names and avatars will not be changed.</p>
                    <div class="confirm-popup-buttons">
                        <button id="sb-confirm-reset-btn">Yes, Reset</button>
                        <button id="sb-cancel-reset-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- What's Missing? Game -->
        <div class="tool-card" id="whats-missing-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>What's Missing? Game</h2>
            <div class="wm-settings">
                <div class="flashcard-controls">
                    <label for="whats-missing-category">Category:</label>
                    <select id="whats-missing-category"></select>
                </div>
                <div class="flashcard-controls">
                    <label for="whats-missing-difficulty">Difficulty:</label>
                    <select id="whats-missing-difficulty">
                        <option value="easy">Easy (6s)</option>
                        <option value="normal" selected>Normal (4s)</option>
                        <option value="hard">Hard (2.5s)</option>
                    </select>
                </div>
                <div class="flashcard-controls">
                    <label for="wm-card-count">Cards:</label>
                    <select id="wm-card-count">
                        <option value="4">4</option>
                        <option value="6" selected>6</option>
                        <option value="9">9</option>
                        <option value="12">12</option>
                        <option value="15">15</option>
                        <option value="custom">Custom</option>
                    </select>
                    <input type="number" id="wm-custom-card-count" class="hidden" min="2" max="50" value="12" style="width: 70px; padding: 5px; border-radius: 5px; border: 1px solid #ccc;">
                </div>
                <div class="flashcard-controls">
                    <label for="wm-missing-count">Missing:</label>
                    <select id="wm-missing-count">
                        <option value="1" selected>1 Card</option>
                        <option value="2">2 Cards</option>
                        <option value="3">3 Cards</option>
                        <option value="4">4 Cards</option>
                    </select>
                </div>
                <button id="whats-missing-start-btn">Start</button>
                <!-- THIS IS THE NEW BUTTON -->
                <button id="wm-goto-scoreboard-btn" title="Go to Scoreboard">üèÖ</button>
            </div>
            <div id="whats-missing-status">Select a category and start the game!</div>
            <div class="whats-missing-grid" id="whats-missing-grid"></div>
        </div>

        <!-- Image Reveal Game -->
        <div class="tool-card" id="image-reveal-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Image Reveal Game</h2>
            <div class="ir-setup-controls">
                <input type="file" id="ir-image-input" accept="image/*" class="hidden" multiple>
                <label for="ir-image-input" class="button-like-label">Upload Image(s)</label>
                <div class="ir-option">
                    <label for="ir-grid-size">Grid:</label>
                    <select id="ir-grid-size">
                        <option value="3x2">Easy (3x2)</option>
                        <option value="5x4" selected>Normal (5x4)</option>
                        <option value="8x6">Hard (8x6)</option>
                        <option value="10x8">Expert (10x8)</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="ir-custom-grid-inputs hidden">
                    <input type="number" id="ir-custom-cols" placeholder="Cols" min="1" max="30" value="5"> x
                    <input type="number" id="ir-custom-rows" placeholder="Rows" min="1" max="30" value="4">
                </div>
                <div class="ir-option">
                    <label for="ir-reveal-mode">Mode:</label>
                    <select id="ir-reveal-mode">
                        <option value="manual" selected>Manual</option>
                        <option value="auto">Automatic (2s)</option>
                        <option value="custom">Custom Speed</option>
                    </select>
                </div>
                 <div class="ir-custom-speed-input hidden">
                    <input type="number" id="ir-custom-speed" placeholder="Sec" min="0.1" step="0.1" value="2"> s
                </div>
                <!-- The button has been MOVED -->
            </div>
            <div class="ir-game-controls">
                <button id="ir-start-pause-btn" class="hidden">Start</button>
                <button id="ir-manual-reveal-btn" class="hidden">Open Tile</button>
                <button id="ir-reveal-all-btn" class="hidden">Answer</button>
                <button id="ir-reset-grid-btn" class="hidden">Reset</button>
                <button id="ir-next-image-btn" class="hidden">Next Image</button>
                <button id="ir-new-game-btn" class="hidden">New Game</button>
                <!-- THIS IS THE NEW LOCATION for the button -->
                <button id="ir-goto-scoreboard-btn" class="hidden" title="Go to Scoreboard">üèÖ</button>
            </div>
            <div class="ir-game-area">
                <div id="ir-image-container">
                    <img id="ir-image" src="" alt="Image to be revealed">
                    <div id="ir-grid-overlay"></div>
                </div>
                 <div id="ir-status-bar">
                    <span id="ir-sequence-status"></span>
                    <span id="ir-game-status">Upload an image to begin!</span>
                </div>
            </div>
        </div>

        <!-- Answer Me This! (Jeopardy) -->
        <div class="tool-card" id="jeopardy-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Answer Me This!</h2>
            <div class="jeopardy-container">
                <div id="jeopardy-play-mode">
                    <div class="jeopardy-play-controls">
                        <button id="jeopardy-edit-game-btn">Edit</button>
                        <button id="jeopardy-new-game-btn">New Game</button>
                        <!-- THIS IS THE NEW BUTTON -->
                        <button id="jeopardy-goto-scoreboard-btn" title="Go to Scoreboard">üèÖ</button>
                        <div class="jeopardy-load-game-wrapper">
                             <label for="jeopardy-load-select">Load Saved Game:</label>
                             <select id="jeopardy-load-select">
                                <option value="">-- Select Game --</option>
                             </select>
                        </div>
                    </div>
                    <div id="jeopardy-board-container">
                        <div class="jeopardy-board-placeholder">
                            <h3>Welcome to Answer Me This!</h3>
                            <p>Load a saved game or click "Edit Game" to create a new one.</p>
                        </div>
                    </div>
                </div>
                <div id="jeopardy-edit-mode" class="hidden">
                    <div class="jeopardy-edit-toolbar">
                        <div class="jeopardy-edit-toolbar-left">
                            <h3>Game Editor</h3>
                            <button id="jeopardy-add-category-btn">+ Add Category</button>
                            <button id="jeopardy-export-game-btn" title="Export All Games">üì§</button>
                            <input type="file" id="jeopardy-import-game-input" accept=".json" class="hidden">
                            <label for="jeopardy-import-game-input" class="button-like-label" title="Import Games">üì•</label>
                        </div>
                        <div class="jeopardy-edit-actions">
                             <input type="text" id="jeopardy-game-title-input" placeholder="Enter Game Name to Save...">
                             <button id="jeopardy-save-game-btn" title="Save Game">üíæ</button>
                             <button id="jeopardy-delete-game-btn" title="Delete Selected Game">üóëÔ∏è</button>
                             <button id="jeopardy-play-game-btn">‚ñ∂Ô∏è Start</button>
                        </div>
                    </div>
                    <div id="jeopardy-edit-area"></div>
                </div>
            </div>

            <div id="jeopardy-clue-modal" class="hidden">
                <div class="jeopardy-clue-content">
                    <button id="jeopardy-modal-close-x" class="jeopardy-modal-close-x" title="Close">‚úñ</button>
                    <div id="jeopardy-clue-category">Category</div>
                    <div id="jeopardy-clue-points">$100</div>
                    <div id="jeopardy-clue-answer-text">Answer text goes here.</div>
                    <div id="jeopardy-clue-image-container" class="hidden">
                        <img id="jeopardy-clue-image" src="" alt="Clue Image">
                    </div>
                    <div id="jeopardy-clue-question" class="hidden">The question is revealed here.</div>
                    <div class="jeopardy-clue-buttons">
                        <button id="jeopardy-reveal-question-btn">Show Answer</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bingo Picker -->
        <div class="tool-card" id="bingo-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Bingo Picker</h2>
            <div class="bingo-controls-panel">
                 <div class="bingo-top-controls">
                    <div class="bingo-source-select">
                        <label for="bingo-list-select">Use List From:</label>
                        <select id="bingo-list-select">
                            <option value="custom">-- Custom List Below --</option>
                        </select>
                    </div>
                    <div class="bingo-buttons">
                        <button id="bingo-pick-btn">Card</button>
                        <button id="bingo-reset-btn">Reset</button>
                        <!-- THIS IS THE NEW BUTTON -->
                        <button id="bingo-goto-scoreboard-btn" title="Go to Scoreboard">üèÖ</button>
                    </div>
                </div>
                <textarea id="bingo-list-input" placeholder="Or, enter items here, one per line..."></textarea>
            </div>
            <div class="bingo-display-area">
                <div id="bingo-picked-item-display">BINGO!</div>
                <div id="bingo-picked-container" class="hidden">
                    <h4>Already Picked:</h4>
                    <div id="bingo-picked-list"></div>
                </div>
            </div>
        </div>

        <!-- Mystery Word Game -->
        <div class="tool-card" id="mystery-word-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Mystery Word</h2>
            <div class="mw-container">
                <div id="mw-setup-controls">
                    <div class="mw-input-wrapper">
                        <input type="password" id="mw-word-input" placeholder="Enter a word or phrase...">
                        <button id="mw-toggle-word-btn">Show</button>
                    </div>
                    <div class="mw-options-wrapper">
                        <div class="mw-option-group">
                            <label for="mw-theme-select">Theme:</label>
                            <select id="mw-theme-select">
                                <option value="rocket" selected>Rocket</option>
                                <option value="cake">Cake</option>
                                <option value="dino">Dinosaur</option>
                                <option value="burger">Hamburger</option>
                            </select>
                        </div>
                        <div class="mw-option-group">
                            <label for="mw-tries-select">Misses Allowed:</label>
                            <select id="mw-tries-select">
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7" selected>7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                            </select>
                        </div>
                    </div>
                    <button id="mw-start-game-btn">Start Game</button>
                </div>

                <div id="mw-game-container" class="hidden">
                    <div id="mw-visual-area">
                        <img id="mw-visual-image" src="" alt="Game progress visual">
                    </div>
                    <div id="mw-game-area">
                        <div id="mw-tries-display">Tries Left: 7</div>
                        <div id="mw-word-display"></div>
                        <div id="mw-keyboard"></div>
                        <div id="mw-game-actions">
                            <button id="mw-reveal-word-btn">Answer</button>
                            <button id="mw-new-game-btn">Reset</button>
                            <!-- THIS IS THE NEW BUTTON -->
                            <button id="mw-goto-scoreboard-btn" title="Go to Scoreboard">üèÖ</button>
                        </div>
                    </div>
                </div>

                <div id="mw-end-game-overlay" class="hidden">
                    <div class="mw-end-game-content">
                        <button class="mw-popup-close">‚úñ</button>
                        <h3 id="mw-end-game-message">You Win!</h3>
                        <p id="mw-revealed-word">WORD</p>
                        <button id="mw-play-again-btn">Play Again</button>
                    </div>
                </div>
                 <!-- Dedicated canvas for this tool's confetti -->
                <canvas id="mw-confetti-canvas"></canvas>
            </div>
        </div>

        <!-- Activity Spinner -->
        <div class="tool-card" id="spinner-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Activity Spinner</h2>
            <div id="spinner-grid-view">
                <div class="spinner-grid-top-controls">
                    <label for="spinner-flashcard-select">Category:</label>
                    <select id="spinner-flashcard-select">
                        <option value="">-- Manual List --</option>
                    </select>
                </div>
                <div class="spinner-display-wrapper">
                    <div class="spinner-container-grid" id="spinner-container-grid">
                        <div class="spinner-wheel-grid" id="spinner-wheel-grid"></div>
                    </div>
                </div>
                <div id="spinner-result-display-grid" class="result-display" aria-live="polite"></div>
                <button id="spinner-spin-button-grid" class="spin-button-grid">SPIN!</button>
            </div>
            <div id="spinner-fullscreen-view" class="hidden">
                <div class="main-container">
                    <div class="spinner-section">
                        <button id="spinner-spin-button" class="spin-button-top">SPIN!</button>
                        <div class="spinner-container" id="spinner-container">
                            <div class="spinner-wheel" id="spinner-wheel"></div>
                        </div>
                        <div id="spinner-result-display" class="result-display" aria-live="polite"></div>
                    </div>
                    <div class="config-section">
                        <h2>Customize Spinner</h2>
                        <div class="config-block">
                           <h3>Load & Manage Items</h3>
                           <select id="spinner-flashcard-select_fs">
                               <option value="">-- Manual List --</option>
                           </select>
                           <ul id="spinner-word-list_fs" class="word-list item-list" style="margin-top: 15px;"></ul>
                           <div class="add-word-form" style="margin-top: 15px;">
                               <input type="text" id="spinner-word-input_fs" placeholder="Enter word or phrase">
                               <input type="file" id="spinner-segment-image-input_fs" accept="image/*" style="display: none;">
                               <label for="spinner-segment-image-input_fs" class="upload-button small-upload-btn" title="Add image to this item">üñºÔ∏è</label>
                               <button id="spinner-add-word-button_fs">Add</button>
                           </div>
                           <div id="spinner-segment-image-preview_fs" class="image-preview-area"></div>
                        </div>
                         <div class="config-block">
                            <h3>Customize Caps</h3>
                            <input type="file" id="spinner-cap-image-upload" accept="image/*" style="display: none;">
                            <label for="spinner-cap-image-upload" class="upload-button">Upload Cap Image</label>
                            <button id="spinner-remove-cap-image" class="remove-button" style="display: none;">Remove Image</button>
                         </div>
                         <div class="config-block">
                            <h3>Adjust Text Size</h3>
                            <div class="font-size-control">
                                <label for="spinner-font-size-slider">Size:</label>
                                <input type="range" id="spinner-font-size-slider" min="8" max="30" value="18">
                                <span id="spinner-font-size-value">18px</span>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3D Dice Roller -->
        <div class="tool-card" id="dice-roller-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>3D Dice Roller</h2>
            <div class="dice-roller-controls">
                <div class="dr-control-group">
                    <label for="dr-dice-count">Dice:</label>
                    <select id="dr-dice-count">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
                <div class="dr-control-group">
                    <label for="dr-gravity-level">Gravity:</label>
                    <select id="dr-gravity-level">
                        <option value="1" selected>Normal</option>
                        <option value="2">Floaty</option>
                        <option value="3">Super Floaty</option>
                        <option value="4">Moon</option>
                    </select>
                </div>
                <button id="dr-roll-btn">Roll Dice!</button>
                <div class="dr-control-group">
                    <input type="file" id="dr-table-image-upload" class="hidden" accept="image/*">
                    <label for="dr-table-image-upload" class="button-like-label">Upload Table Image</label>
                    <button id="dr-remove-table-image-btn" class="hidden" style="background-color: #d9534f;">Remove Image</button>
                </div>
            </div>
            <div id="dice-canvas-container"></div>
            <div id="dice-result-popup" class="hidden">
                <div class="dice-result-content">
                    <h3>Total Roll:</h3>
                    <p id="dice-result-total">0</p>
                    <button id="dice-result-close-btn">Close</button>
                </div>
            </div>
        </div>

        <!-- Simple Whiteboard -->
        <div class="tool-card" id="whiteboard-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Simple Whiteboard</h2>
            <div class="whiteboard-controls">
                <input type="color" id="wb-color" value="#000000">
                <input type="range" id="wb-width" min="1" max="150" value="10">
                <div class="wb-tool-group">
                    <label for="wb-shape-tool">Paint:</label>
                    <select id="wb-shape-tool">
                        <option value="pen">Pen</option>
                        <option value="line">Line</option>
                        <option value="rectangle">Rectangle</option>
                        <option value="circle">Circle</option>
                        <option value="triangle">Triangle</option>
                        <option value="stamp">Stamp</option>
                    </select>
                </div>
                <div id="wb-advanced-controls">
                    <div id="wb-color-palette"></div>
                    <div class="wb-tool-group">
                        <label for="wb-brush-tool">Brush:</label>
                        <select id="wb-brush-tool">
                            <option value="solid">Solid</option>
                            <option value="rainbow">Rainbow</option>
                            <option value="spray">Spray Paint</option>
                            <option value="dashed">Dashed</option>
                            <option value="dotted">Dotted</option>
                        </select>
                    </div>
                </div>
                <div id="wb-stamp-controls" class="hidden">
                    <select id="wb-stamp-set-select">
                        <option>Loading Sets...</option>
                    </select>
                    <div id="wb-stamp-card-container" class="wb-stamp-selection-grid"></div>
                    <div class="wb-tool-group wb-stamp-size-control">
                        <label for="wb-stamp-size">Size:</label>
                        <input type="range" id="wb-stamp-size" min="20" max="300" value="100">
                    </div>
                </div>
                <div class="wb-actions-group">
                    <button id="wb-paint-btn" class="wb-util-btn" title="Paint Brush">üñåÔ∏è</button>  
                    <button id="wb-eraser-btn" class="wb-util-btn" title="Eraser">üßΩ</button>   
                    <button id="wb-undo-btn" class="wb-util-btn" disabled>Undo</button>
                    <button id="wb-clear-btn" class="wb-util-btn">üóëÔ∏è</button>
                    <button id="wb-save-btn" class="wb-util-btn">üíæ</button>
                </div>
            </div>
            <div id="wb-canvas-wrapper">
                <canvas id="whiteboard-canvas"></canvas>
                <canvas id="whiteboard-rainbow-canvas"></canvas>
                <canvas id="whiteboard-temp-canvas"></canvas>
            </div>
        </div>

        <!-- Phonics Practice Module -->
        <div class="tool-card" id="phonics-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Phonics Practice</h2>
            <div class="phonics-grid-view">
                <div id="phonics-display-panel_grid">
                    <div class="phonics-card_grid">
                        <h3 id="phonics-card-word_grid"></h3>
                        <img id="phonics-card-image_grid" src="assets/phonics/placeholder.png" alt="Phonics card image">
                    </div>
                    <div class="phonics-nav_grid">
                        <button id="phonics-prev-btn_grid">‚¨ÖÔ∏è</button>
                        <button id="phonics-sound-btn_grid">üîä</button>
                        <button id="phonics-next-btn_grid">‚û°Ô∏è</button>
                    </div>
                    <div id="phonics-card-counter_grid"></div>
                </div>
            </div>
            <div class="phonics-fullscreen-view hidden">
                <div id="phonics-controls-panel"></div>
                <div class="phonics-main-area">
                    <div class="phonics-load-controls">
                        <div id="phonics-card-counter"></div>
                        <button id="phonics-load-btn">Load Set</button>
                        <div class="phonics-top-nav">
                            <button id="phonics-prev-btn">‚¨ÖÔ∏è Prev</button>
                            <button id="phonics-next-btn">Next ‚û°Ô∏è</button>
                            <button id="phonics-sound-btn">üîä</button>
                        </div>
                        <div class="phonics-cumulative-option">
                            <input type="checkbox" id="phonics-cumulative-check" checked>
                            <label for="phonics-cumulative-check" title="Practice sounds from previous sets too. Recommended!">Cumulative Practice</label>
                        </div>
                    </div>
                    <div id="phonics-display-panel" class="hidden">
                        <div class="phonics-card">
                            <h3 id="phonics-card-word"></h3>
                            <img id="phonics-card-image" src="" alt="Phonics card image">
                            <p id="phonics-card-sentence"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Classroom Noise Meter -->
        <div class="tool-card" id="noise-meter-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Classroom Noise Meter</h2>
            <div class="nm-controls">
                <button id="nm-start-btn">Start Meter</button>
                <div class="nm-control-group">
                    <label for="nm-theme-select">Theme:</label>
                    <select id="nm-theme-select">
                        <option value="cat" selected>Sleeping Cat</option>
                        <option value="campfire">Campfire</option>
                        <option value="windy">Windy Day</option>
                    </select>
                </div>
                <div class="nm-control-group">
                    <label for="nm-sensitivity">Sensitivity:</label>
                    <input type="range" id="nm-sensitivity" min="0.5" max="3.0" value="1.5" step="0.1">
                    <span id="nm-sensitivity-value">1.5</span>
                </div>
            </div>
            <div id="nm-visual-container">
                <div id="nm-theme-cat" class="nm-theme active">
                    <img id="nm-cat-image" src="assets/noise-meter/cat-state1.png" alt="A sleeping cat">
                </div>
                <div id="nm-theme-campfire" class="nm-theme">
                    <img id="nm-campfire-image" src="assets/noise-meter/fire-state1.png" alt="A small campfire">
                </div>
                <div id="nm-theme-windy" class="nm-theme">
                    <img id="nm-windy-image" src="assets/noise-meter/windy-state1.png" alt="A person on a calm day">
                </div>
            </div>
            <div id="nm-volume-meter-container">
                <div id="nm-volume-meter-fill"></div>
            </div>
            <div id="nm-status">Meter is off. Click "Start" to begin.</div>
        </div>

        <!-- Sound Board -->
        <div class="tool-card" id="sound-board-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Sound Board</h2>

            <!-- Play Mode -->
            <div id="sb-play-mode">
                <!-- This wrapper allows the player and button to be centered as a single unit -->
                <div class="sb-top-panel">
                    <div class="sb-music-player">
                        <div class="sb-music-controls">
                            <input type="file" id="sb-music-load-input" class="hidden" multiple accept="audio/*">
                            <label for="sb-music-load-input" class="button-like-label" title="Load Music Tracks">üéµ Load</label>
                            <button id="sb-music-prev" title="Previous Track">‚èÆÔ∏è</button>
                            <button id="sb-music-play" title="Play/Pause">‚ñ∂Ô∏è</button>
                            <button id="sb-music-next" title="Next Track">‚è≠Ô∏è</button>
                            <button id="sb-music-stop" title="Stop">‚èπÔ∏è</button>
                            <input type="range" id="sb-music-volume" min="0" max="1" step="0.01" value="0.75" title="Volume">
                        </div>
                        <div class="sb-music-track-info">
                            <span id="sb-current-track">No track playing</span>
                            <details id="sb-track-list-details" style="display: none;">
                                <summary>Track List</summary>
                                <ul id="sb-track-list-ul"></ul>
                            </details>
                        </div>
                    </div>
                    <div class="sb-main-controls">
                        <button id="sb-edit-btn">Edit Board</button>
                    </div>
                </div>

                <div id="sb-buttons-grid">
                    <!-- Sound effect buttons will be populated here -->
                </div>
            </div>

            <!-- Edit Mode (Initially Hidden) -->
            <div id="sb-edit-mode" class="hidden">
                <div class="sb-edit-top-bar">
                    <div class="sb-edit-top-bar-left">
                        <select id="sb-load-select">
                            <option value="">-- New Sound Board --</option>
                        </select>
                        <input type="text" id="sb-board-name-input" placeholder="Enter Board Name...">
                    </div>
                    <div class="sb-edit-top-bar-right">
                        <button id="sb-save-btn" title="Save Board">üíæ</button>
                        <button id="sb-delete-btn" title="Delete Selected Board" disabled>üóëÔ∏è</button>
                        <button id="sb-export-btn" title="Export All Boards">üì§</button>
                        <input type="file" id="sb-import-input" class="hidden" accept=".json">
                        <label for="sb-import-input" class="button-like-label" title="Import Boards">üì•</label>
                        <div class="sb-edit-separator"></div>
                        <button id="sb-add-sound-btn" title="Add New Sound Button">+</button>
                        <button id="sb-exit-edit-btn">Done</button>
                    </div>
                </div>
                 <div id="sb-buttons-grid-edit">
                    <!-- The 'buttonsGrid' element is shared and repopulated -->
                 </div>
            </div>
        </div>

        <!-- Flashcard Manager -->
        <div class="tool-card" id="flashcard-manager-tool">
            <button class="favorite-btn" title="Add to Favorites">‚ô°</button>
            <h2>Flashcard Manager</h2>
            <div class="flashcard-manager-controls">
                <div class="fm-row">
                    <select id="fm-set-select"><option value="">-- Create New Set --</option></select>
                    <button id="fm-delete-set-btn" disabled>Delete Set</button>
                </div>
                <div class="fm-row">
                    <input type="text" id="fm-set-name" placeholder="New or Loaded Set Name">
                </div>
                <div class="fm-row">
                    <input type="text" id="fm-card-text" placeholder="Card Text (e.g., Dog)">
                    <input type="file" id="fm-card-img" accept="image/*" multiple>
                    <button id="fm-add-card-btn">Add Card</button>
                    <button id="fm-export-btn">Export</button>
                    <input type="file" id="fm-import-input" class="hidden" accept=".json,application/json">
                    <label for="fm-import-input" id="fm-import-label" class="button-like-label">Import</label>
                </div>
            </div>
            <p><strong>Cards in this set:</strong></p>
            <div id="fm-current-cards"></div>
            <button id="fm-save-set-btn">Save Set</button>
        </div>
        
    </div>

    <!-- The small, initial file upload confirmation popup -->
    <div id="file-upload-modal" class="confirm-popup hidden">
        <div class="confirm-popup-content">
            <h3 id="file-upload-title">Upload File</h3>
            <p id="file-upload-prompt">Please select a file to upload.</p>
            <div class="confirm-popup-buttons">
                <button id="file-upload-confirm-btn">Choose File</button>
                <button id="file-upload-cancel-btn">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- The new interstitial page for handling fullscreen file uploads -->
    <div id="upload-confirm-page" class="hidden">
        <button id="upload-confirm-close-btn">Confirm / Close</button>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="js/lib/matter.min.js"></script>
    <script src="js/main.js" type="module"></script>
</body>
</html>